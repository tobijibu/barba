<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Transition | Barba - にほんご。</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta property="og:title" content="Transition | Barba - にほんご。"><meta property="og:url"><meta property="og:type" content="article"><link rel="icon" href="https://tr.you84815.space/barba/favicon.ico"><link rel="stylesheet" href="./css/main.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-106478577-1', 'auto');</script></head><body><div id="container"><header><div class="icon"><a class="no-barba" href="https://tr.you84815.space/"><svg width="16" height="16"><rect width="16" height="16" fill="#e0e0e0"></rect></svg></a></div><div class="navi_toggle" onclick="toggleMenu()"><svg id="menu_close" width="24" height="24" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg><svg id="menu_open" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></div><div class="title">Barba - <a class="no-barba" href="https://tr.you84815.space/">にほんご。</a></div></header><div class="navi" id="navi"><ul class="menu"><li><a class="index" href="./index.html">Home</a></li><li><a href="./introduction.html">Introduction</a></li><li><a href="./how-it-works.html">How it works</a></li><li><a href="./installation.html">Installation</a></li><li><a class="active" href="./transition.html">Transition</a></li><li><a href="./events.html">Events</a></li><li><a href="./views.html">Views</a></li><li><a href="./cache.html">Cache</a></li><li><a href="./prefetch.html">Prefetch</a></li><li><a href="./partial-output.html">Partial Output</a></li><li><span onclick="toggleApi()">API</span><ul class="hidden" id="navi_api"><li><a href="./api/base-cache.html">BaseCache</a></li><li><a href="./api/base-transition.html">BaseTransition</a></li><li><a href="./api/base-view.html">BaseView</a></li><li><a href="./api/dispatcher.html">Dispatcher</a></li><li><a href="./api/history-manager.html">HistoryManager</a></li><li><a href="./api/pjax.html">Pjax</a></li><li><a href="./api/pjax-dom.html">Pjax.Dom</a></li><li><a href="./api/prefetch.html">Prefetch</a></li><li><a href="./api/utils.html">Utils</a></li></ul></li><li><span onclick="toggleDemos()">Demos</span><ul class="hidden" id="navi_demos"><li><a class="external-link" href="http://barbajs.org/demo/grid/index.html" target="_blank" rel="noopener noreferrer">official - Grid</a></li><li><a class="external-link" href="http://barbajs.org/demo/nextprev/index.html" target="_blank" rel="noopener noreferrer">official - Next/Prev</a></li><li><a class="external-link" href="http://barbajs.org/demo/nextprev-circle/index.html" target="_blank" rel="noopener noreferrer">official - Circles</a></li><li><a href="./demo/basic/1.html" target="_blank" rel="noopener noreferrer">Basic</a></li><li><a href="./demo/hide-show/1.html" target="_blank" rel="noopener noreferrer">HideShow</a></li><li><a href="./demo/fade/1.html" target="_blank" rel="noopener noreferrer">Fadein/out</a></li><li><a href="./demo/event/1.html" target="_blank" rel="noopener noreferrer">Event</a></li><li><a href="./demo/view/1.html" target="_blank" rel="noopener noreferrer">View</a></li><li><a href="./demo/cache/1.html" target="_blank" rel="noopener noreferrer">Cache</a></li><li><a href="./demo/prefetch/1.html" target="_blank" rel="noopener noreferrer">Prefetch</a></li><li><a href="./demo/partial-output/1.html" target="_blank" rel="noopener noreferrer">Partial Output</a></li><li><a href="./demo/no-barba/1.html" target="_blank" rel="noopener noreferrer">No Barba</a></li></ul></li><li><a href="./faq.html">FAQ</a></li><li><a href="./various.html">Various</a></li><li class="cls" style="font-size:.8em"><a class="external-link" href="https://github.com/luruke/barba.js" target="_blank" rel="noopener noreferrer">Github</a></li><li class="cls" style="font-size:.8em"><a class="external-link" href="https://twitter.com/luruke" target="_blank" rel="noopener noreferrer">@luruke</a></li></ul></div><div id="content"><div id="main"><div id="barba-wrapper"><div class="barba-container"><h1>Transition</h1><div id="update_date"><span>更新日: 2018.09.04
</span></div><h2>transition</h2><p>transitionは古いコンテナを隠して、新しいコンテナを表示する
JavaScriptオブジェクトです。</p><p>transitionは<a href="https://github.com/luruke/barba.js/blob/master/src/Transition/BaseTransition.js" target="_blank" rel="noopener noreferrer"><code>Barba.BaseTransiton</code></a>オブジェクトを拡張する必要があります。</p><blockquote>メモ：ページ遷移は新しいページをロードする前に開始します。
このように、次のページがロードされる前でもページ遷移を開始することができます。</blockquote><p>このオブジェクトを拡張すると以下のメンバを継承します。</p><div class="table-box"><table class="my-table"><tr><th>メンバ</th><th class="detail">説明</th></tr><tr><td><code>start</code></td><td>ページ遷移が始まると自動的に呼び出される関数です。
(言わばtransitionのコンストラクタです)</td></tr><tr><td><code>done</code></td><td>ページ遷移が終了した時に呼び出す必要がある関数です。<br><b>この関数を忘れないでください！</b></td></tr><tr><td><code>oldContainer</code></td><td>古いコンテナの<code>HTMLElement</code>です。</td></tr><tr><td><code>newContainerLoading</code></td><td>新しいコンテナのローディングを示す<code>Promise</code>です。</td></tr><tr><td><code>newContainer</code></td><td>新しいコンテナの<code>HTMLElement</code>です。
(<code>visibility: hidden;</code>が付与されます。)<br><b>メモ：<code>newContainerLoading</code>が完了するまで<code>undefined</code>です。</b></td></tr></table></div><h2 id="hideshow-example">基本的なページ遷移</h2><p>通常barba.jsは、ただのHideShow(非表示→表示)のページ遷移です。
どのように動くか理解するために作成してみましょう。</p><pre><code><span class="hljs-keyword">var</span> HideShowTransition = Barba.BaseTransition.extend({
  <span class="hljs-attr">start</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.newContainerLoading.then(<span class="hljs-keyword">this</span>.finish.bind(<span class="hljs-keyword">this</span>));
  },

  <span class="hljs-attr">finish</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">document</span>.body.scrollTop = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.done();
  }
});</code></pre><blockquote>お気づきのように、<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">Promise</a>を使っています。
barba.jsには便利なPromiseのpolyfillもあります。</blockquote><p>次に、作成したページ遷移を指定します</p><pre><code>Barba.Pjax.getTransition = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> HideShowTransition;
};</code></pre><p>[<a href="./demo/basic/1.html" target="_blank" rel="noopener noreferrer">デモ - Basic</a>]</p><h2 id="fadetransition-example">フェードインアウト</h2><p>次はより複雑なページ遷移を作成してみましょう。
FadeTransitionはjQueryの<code>.animate()</code>を使います。</p><blockquote>もちろん他のJSライブラリを使っても良いですし、
手書きのスクリプトや、CSSのtransitionでも、
どんな方法でも構いません。</blockquote><pre><code><span class="hljs-keyword">var</span> FadeTransition = Barba.BaseTransition.extend({
  <span class="hljs-attr">start</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/**
     * この関数はページ遷移が始まったらすぐに自動的に呼び出されます。
     * this.newContainerLoadingは新しいコンテナのローディングを示すpromiseです。
     * (barba.jsには便利なPromiseのpolyfillもあります。)
     */</span>

    <span class="hljs-comment">// ローディングが終わるとすぐに、</span>
    <span class="hljs-comment">// 古いページをフェードアウトさせて、新しいページをフェードインします</span>
    <span class="hljs-built_in">Promise</span>
      .all([<span class="hljs-keyword">this</span>.newContainerLoading, <span class="hljs-keyword">this</span>.fadeOut()])
      .then(<span class="hljs-keyword">this</span>.fadeIn.bind(<span class="hljs-keyword">this</span>));
  },

  <span class="hljs-attr">fadeOut</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/**
     * this.oldContainerは古いコンテナのHTMLElementです。
     */</span>

    <span class="hljs-keyword">return</span> $(<span class="hljs-keyword">this</span>.oldContainer).animate({ <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span> }).promise();
  },

  <span class="hljs-attr">fadeIn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/**
     * this.newContainerは新しいコンテナのHTMLElementです。
     * この段階でnewContainerはDOM上に含まれています。
     * (#barba-container内にあり、visibility: hiddenです。)
     * メモ：newContainerはnewContainerLoadingを解決した後に利用できます。
     */</span>

    <span class="hljs-keyword">var</span> _this = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> $el = $(<span class="hljs-keyword">this</span>.newContainer);

    $(<span class="hljs-keyword">this</span>.oldContainer).hide();

    $el.css({
      <span class="hljs-attr">visibility</span> : <span class="hljs-string">'visible'</span>,
      <span class="hljs-attr">opacity</span> : <span class="hljs-number">0</span>
    });

    $el.animate({ <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span> }, <span class="hljs-number">400</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">/**
       * 遷移が終了したら.done()を呼び出すのを忘れないでください！
       * .done()は自動的にDOMから古いコンテナを削除します。
       */</span>

      _this.done();
    });
  }
});

<span class="hljs-comment">/**
 * 次に、Barbaに作成した遷移処理を指定します。
 */</span>

Barba.Pjax.getTransition = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">/**
   * ここでロジックと遷移処理を指定できます！
   * 例えばページ毎や、リンク毎に別の遷移処理を指定することができます。
   */</span>

  <span class="hljs-keyword">return</span> FadeTransition;
};</code></pre><p>[<a href="./demo/fade/1.html" target="_blank" rel="noopener noreferrer">デモ - Fade</a>]</p><br><br><div class="license"><p>&copy; 2016
 Luigi De Rosa Released under the <a href="https://github.com/luruke/barba.js/blob/master/LICENSE">MIT license</a></p><p>このコンテンツはLuigi De Rosa(luruke)による<a href="http://barbajs.org/">Barbaドキュメント</a>を翻訳/改変したものです。<br></p></div></div></div></div></div><footer><span> &copy; <span id="copy_year">2017</span> tobijibu</span></footer></div><noscript id="deferred-styles"><link href="./css/lazy.css" rel="stylesheet"></noscript><script src="./js/main.js" defer></script><div id="src" hidden></div></body></html>